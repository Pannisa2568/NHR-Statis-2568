<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>‡πÅ‡∏ö‡∏ö‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô NHR School</title>
  <link href="https://fonts.googleapis.com/css2?family=Prompt&display=swap" rel="stylesheet" />
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    body {
      font-family: 'Prompt', sans-serif;
      background-color: #ffffff;
      color: #000000;
      padding: 1rem;
      max-width: 600px;
      margin: auto;
    }
    h1 {
      text-align: center;
      color: #000000;
      margin-top: 0.5rem;
    }
    .logo {
      display: block;
      height: auto;
      margin: 0.5rem auto;
    }
    .logo-1 {
      max-width: 100px;
    }
    .logo-2 {
      max-width: 140px;
    }
    #currentDate {
      font-size: 1.2rem;
      font-weight: 500;
      margin-bottom: 1rem;
      text-align: center;
    }
    form {
      border: 3px solid orange;
      border-radius: 10px;
      padding: 1rem;
    }
    label {
      display: block;
      margin-top: 1rem;
    }
    input[type="number"],
    select {
      width: 100%;
      padding: 0.5rem;
      margin-top: 0.2rem;
      border: 1px solid orange;
      border-radius: 5px;
    }
    button {
      width: 100%;
      padding: 0.8rem;
      font-size: 1rem;
      border: none;
      border-radius: 5px;
      background-color: red;
      color: white;
      margin-top: 1.5rem;
      cursor: pointer;
      transition: background-color 0.3s ease;
    }
    button:disabled {
      background-color: gray;
    }
    .dashboard {
      margin-top: 2rem;
      text-align: center;
    }
    .back-btn {
      background-color: #555;
      margin-top: 1rem;
    }
  </style>
</head>
<body>
  <img class="logo logo-1" src="https://img2.pic.in.th/pic/25673da72eed99cbdfc9.png" alt="Logo1" />
  <img class="logo logo-2" src="https://img5.pic.in.th/file/secure-sv1/2-5-2568-8-05-20.png" alt="Logo2" />
  <h1>‡πÅ‡∏ö‡∏ö‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô NHR School 2568</h1>
  <p id="currentDate"></p>

  <form id="attendanceForm">
    <label>‡∏ä‡∏±‡πâ‡∏ô/‡∏´‡πâ‡∏≠‡∏á
      <select name="entry.522842455" required>
        <option value="">-- ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å --</option>
        <option>‡∏≠‡∏ô‡∏∏‡∏ö‡∏≤‡∏• 2/1</option><option>‡∏≠‡∏ô‡∏∏‡∏ö‡∏≤‡∏• 2/2</option><option>‡∏≠‡∏ô‡∏∏‡∏ö‡∏≤‡∏• 2/3</option><option>‡∏≠‡∏ô‡∏∏‡∏ö‡∏≤‡∏• 3/1</option>
        <option>‡∏≠‡∏ô‡∏∏‡∏ö‡∏≤‡∏• 3/2</option><option>‡∏≠‡∏ô‡∏∏‡∏ö‡∏≤‡∏• 3/3</option><option>‡∏≠‡∏ô‡∏∏‡∏ö‡∏≤‡∏• 3/4</option><option>‡∏õ.1/1</option>
        <option>‡∏õ.1/2</option><option>‡∏õ.1/3</option><option>‡∏õ.1/4</option><option>‡∏õ.2/1</option><option>‡∏õ.2/2</option>
        <option>‡∏õ.2/3</option><option>‡∏õ.2/4</option><option>‡∏õ.3/1</option><option>‡∏õ.3/2</option><option>‡∏õ.3/3</option>
        <option>‡∏õ.3/4</option><option>‡∏õ.4/1</option><option>‡∏õ.4/2</option><option>‡∏õ.4/3</option><option>‡∏õ.4/4</option>
        <option>‡∏õ.5/1</option><option>‡∏õ.5/2</option><option>‡∏õ.5/3</option><option>‡∏õ.5/4</option><option>‡∏õ.5/5</option>
        <option>‡∏õ.6/1</option><option>‡∏õ.6/2</option><option>‡∏õ.6/3</option><option>‡∏õ.6/4</option><option>‡∏õ.6/5</option>
      </select>
    </label>

    <label>üë¶üèª ‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ä‡∏≤‡∏¢‡∏°‡∏≤‡πÄ‡∏£‡∏µ‡∏¢‡∏ô
      <input type="number" name="entry.446341418" value="0" min="0" required />
    </label>

    <label>üëß ‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏´‡∏ç‡∏¥‡∏á‡∏°‡∏≤‡πÄ‡∏£‡∏µ‡∏¢‡∏ô
      <input type="number" name="entry.1572431820" value="0" min="0" required />
    </label>

    <label>üë¶üèª ‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ä‡∏≤‡∏¢‡∏õ‡πà‡∏ß‡∏¢
      <input type="number" name="entry.932967472" value="0" min="0" />
    </label>

    <label>üë¶üèª ‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ä‡∏≤‡∏¢‡∏•‡∏≤
      <input type="number" name="entry.1558724961" value="0" min="0" />
    </label>

    <label>üë¶üèª ‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ä‡∏≤‡∏¢‡∏Ç‡∏≤‡∏î
      <input type="number" name="entry.1652164491" value="0" min="0" />
    </label>

    <label>üëß ‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏´‡∏ç‡∏¥‡∏á‡∏õ‡πà‡∏ß‡∏¢
      <input type="number" name="entry.878207052" value="0" min="0" />
    </label>

    <label>üëß ‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏´‡∏ç‡∏¥‡∏á‡∏•‡∏≤
      <input type="number" name="entry.1277963062" value="0" min="0" />
    </label>

    <label>üëß ‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏´‡∏ç‡∏¥‡∏á‡∏Ç‡∏≤‡∏î
      <input type="number" name="entry.2011543549" value="0" min="0" />
    </label>

    <button type="submit" id="submitBtn">‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</button>
    <button type="button" class="back-btn" onclick="history.back()">‡∏¢‡πâ‡∏≠‡∏ô‡∏Å‡∏•‡∏±‡∏ö</button>
  </form>

  <div class="dashboard">
    <canvas id="summaryChart" width="300" height="300"></canvas>
  </div>

  <audio id="dingSound" src="https://cdn.pixabay.com/audio/2022/03/15/audio_4b7f5d8063.mp3"></audio>

  <script>
    // ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô
    document.getElementById("currentDate").textContent =
      new Date().toLocaleDateString("th-TH", {
        weekday: "long", year: "numeric", month: "long", day: "numeric"
      });

    const form = document.getElementById("attendanceForm");
    const submitBtn = document.getElementById("submitBtn");
    const dingSound = document.getElementById("dingSound");

    form.addEventListener("submit", function (e) {
      e.preventDefault();
      submitBtn.disabled = true;

      const formData = new FormData(form);
      const query = new URLSearchParams(formData).toString();
      const url = "https://docs.google.com/forms/d/e/1FAIpQLScIozo9wi774bgxMN6-ZJz5hqcOOQr5qFjJQixnnVKVydx-dQ/formResponse";
      const bell = new Audio('https://pixabay.com/sound-effects/search/%E0%B8%81%E0%B8%A3%E0%B8%B0%E0%B8%94%E0%B8%B4%E0%B9%88%E0%B8%87');
bell.play();

      fetch(url, {
        method: "POST",
        mode: "no-cors",
        headers: { "Content-Type": "application/x-www-form-urlencoded" },
        body: query,
      }).then(() => {
        submitBtn.style.backgroundColor = "green";
        dingSound.play();

        setTimeout(() => {
          alert("‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏ò‡∏∏‡∏£‡∏Å‡∏≤‡∏£‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏Ç‡∏≠‡∏á‡∏ó‡πà‡∏≤‡∏ô‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ‡πÅ‡∏•‡πâ‡∏ß ‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏Ñ‡πà‡∏∞");
          form.reset();
          document.querySelectorAll('input[type="number"]').forEach(el => el.value = 0);
          submitBtn.style.backgroundColor = "red";
          submitBtn.disabled = false;
        }, 2000);
      });
    });

    // Dashboard ‡∏™‡∏£‡∏∏‡∏õ
    const ctx = document.getElementById('summaryChart').getContext('2d');
    const chart = new Chart(ctx, {
      type: 'bar',
      data: {
        labels: ['üë¶üèª ‡∏°‡∏≤‡πÄ‡∏£‡∏µ‡∏¢‡∏ô', 'üëß ‡∏°‡∏≤‡πÄ‡∏£‡∏µ‡∏¢‡∏ô', 'üë¶üèª ‡∏õ‡πà‡∏ß‡∏¢', 'üëß ‡∏õ‡πà‡∏ß‡∏¢', 'üë¶üèª ‡∏•‡∏≤', 'üëß ‡∏•‡∏≤', 'üë¶üèª ‡∏Ç‡∏≤‡∏î', 'üëß ‡∏Ç‡∏≤‡∏î'],
        datasets: [{
          label: '‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ',
          data: [12, 20, 1, 0, 0, 0, 1, 1], // ‡∏Ñ‡πà‡∏≤‡∏à‡∏≥‡∏•‡∏≠‡∏á‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á
          backgroundColor: [
            '#4caf50', '#81c784', '#ff9800', '#ffcc80',
            '#03a9f4', '#81d4fa', '#f44336', '#ef9a9a'
          ],
        }]
      },
      options: {
        responsive: true,
        plugins: {
          legend: { display: false },
        },
        scales: {
          y: { beginAtZero: true }
        }
      }
    });
  </script>
</body>
</html>
